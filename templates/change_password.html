<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Change Password | Digital Security</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body data-theme="light" class="change-password-page">
  <div class="auth-container">
    <!-- Back Arrow -->
    <a href="{{ url_for('profile') }}" class="back-arrow" style="position: absolute; top: 20px; left: 20px; z-index: 10;">
      <i class="fas fa-arrow-left"></i>
    </a>

    <!-- Theme Toggle (Top Right) -->
    <div class="floating-theme-toggle">
        <span id="theme-icon-change-password" style="font-size: 1.3rem; cursor: pointer;">ðŸŒž</span>
    </div>

    <div class="auth-card glassy">
      <h2>Change Password</h2>
      <form action="#" method="POST">

        <!-- Old Password -->
        <div class="input-icon">
          <i class="fas fa-lock icon-left"></i>
          <input type="password" id="old_password" name="old_password" placeholder="Old Password" required />
        </div>

        <!-- New Password -->
        <div class="input-icon">
          <i class="fas fa-lock icon-left"></i>
          <input type="password" id="new_password" name="new_password" placeholder="New Password" required />
        </div>

        <!-- Password Strength -->
        <div class="strength-meter">
            <p>Password must contain:</p>
            <ul>
                <li id="length" class="invalid">8 characters</li>
                <li id="uppercase" class="invalid">1 uppercase letter</li>
                <li id="lowercase" class="invalid">1 lowercase letter</li>
                <li id="number" class="invalid">2 numbers</li>
                <li id="symbol" class="invalid">1 symbol</li>
            </ul>
        </div>

        <!-- Confirm New Password -->
        <div class="input-icon">
          <i class="fas fa-lock icon-left"></i>
          <input type="password" id="confirm_new_password" name="confirm_new_password" placeholder="Confirm New Password" required />
        </div>

        <!-- Change Password Button -->
        <button type="submit" class="btn full-btn neon-btn">Change Password</button>

      </form>
    </div>
  </div>

  <script>
    // Real-time Password Strength Indicator Script
    const newPasswordInput = document.getElementById('new_password');
    const strengthMeter = document.querySelector('.strength-meter'); // Get the strength meter element
    const length = document.getElementById('length');
    const uppercase = document.getElementById('uppercase');
    const lowercase = document.getElementById('lowercase');
    const number = document.getElementById('number');
    const symbol = document.getElementById('symbol');

    newPasswordInput.addEventListener('input', function() {
      const value = newPasswordInput.value;

      // Show/hide strength meter based on input
      if (value.length > 0) {
          strengthMeter.classList.add('visible');
      } else {
          strengthMeter.classList.remove('visible');
      }

      // Check for 8 characters
      if (value.length >= 8) {
        length.classList.replace('invalid', 'valid');
      } else {
        length.classList.replace('valid', 'invalid');
      }

      // Check for 1 uppercase letter
      if (/[A-Z]/.test(value)) {
        uppercase.classList.replace('invalid', 'valid');
      } else {
        uppercase.classList.replace('valid', 'invalid');
      }

      // Check for 1 lowercase letter
      if (/[a-z]/.test(value)) {
        lowercase.classList.replace('invalid', 'valid');
      } else {
        lowercase.classList.replace('valid', 'invalid');
      }

      // Check for 2 numbers
      if ((value.match(/\d/g) || []).length >= 2) {
        number.classList.replace('invalid', 'valid');
      } else {
        number.classList.replace('valid', 'invalid');
      }

      // Check for 1 symbol
      if (/[^A-Za-z0-9]/.test(value)) {
        symbol.classList.replace('invalid', 'valid');
      } else {
        symbol.classList.replace('valid', 'invalid');
      }
    });

    // Theme Toggle Script (Icon Only)
    const themeIconChangePassword = document.getElementById('theme-icon-change-password');

    function applyThemeChangePassword(mode) {
        document.body.setAttribute('data-theme', mode);
        localStorage.setItem('theme', mode);
        themeIconChangePassword.textContent = mode === 'dark' ? 'ðŸŒ™' : 'ðŸŒž';
    }

    // Apply saved theme on page load
    const savedThemeChangePassword = localStorage.getItem('theme') || 'light';
    applyThemeChangePassword(savedThemeChangePassword);

    themeIconChangePassword.addEventListener('click', () => {
        const mode = document.body.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
        applyThemeChangePassword(mode);
    });

  </script>
</body>
</html> 