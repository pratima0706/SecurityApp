<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Set New Password | Digital Security</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body data-theme="light">
  <!-- ðŸŒ— Floating Theme Toggle -->
  <div class="floating-theme-toggle">
    <span id="theme-icon" style="font-size: 1.3rem; cursor: pointer;">ðŸŒž</span>
  </div>

  <div class="auth-container">
    <div class="auth-card glassy">
      <h2>Set New Password</h2>
      <p class="info-text">Please enter your new password below.</p>

      <form method="POST">
        <!-- New Password -->
        <div class="input-icon">
          <span>ðŸ”’</span>
          <input type="password" id="password" name="password" placeholder="New Password" required autocomplete="new-password" />
        </div>

        <!-- Auto-Generated Password Suggestion Box -->
        <div id="suggestion-box" class="suggestion-box" style="display: none;">
          <div class="suggested-text" id="suggested-password">AbC!234x</div>
          <div class="popup-actions">
            <button type="button" class="btn-sm" id="accept-password">Use Password</button>
            <button type="button" class="btn-sm" id="refresh-password">ðŸ”„</button>
          </div>
        </div>

        <!-- Password Strength Meter -->
        <div id="strength-section" style="display: none;">
          <div class="strength-meter">
            <div id="strength-bar-bg">
              <div id="strength-bar"></div>
            </div>
            <div><b>Password strength:</b> <span id="strength-text"></span></div>
            <ul>
              <li id="length" class="invalid">At least 8 characters</li>
              <li id="uppercase" class="invalid">Uppercase letter</li>
              <li id="lowercase" class="invalid">Lowercase letter</li>
              <li id="number" class="invalid">Number</li>
              <li id="symbol" class="invalid">Special character</li>
            </ul>
          </div>
        </div>

        <!-- Confirm Password -->
        <div class="input-icon">
          <span>ðŸ”’</span>
          <input type="password" id="confirm_password" name="confirm_password" placeholder="Confirm New Password" required />
        </div>

        <!-- Match Status -->
        <div id="match-status" class="match-feedback"></div>

        <!-- Submit Button -->
        <button type="submit" class="btn full-btn" id="submit-btn" disabled>Reset Password</button>
      </form>
    </div>
  </div>

  <!-- Theme Toggle Script -->
  <script>
    const icon = document.getElementById('theme-icon');
    
    icon.addEventListener('click', () => {
      const current = document.body.getAttribute('data-theme');
      const newMode = current === 'dark' ? 'light' : 'dark';
      document.body.setAttribute('data-theme', newMode);
      localStorage.setItem('theme', newMode);
      icon.textContent = newMode === 'dark' ? 'ðŸŒ™' : 'ðŸŒž';
    });

    const saved = localStorage.getItem('theme') || 'light';
    document.body.setAttribute('data-theme', saved);
    icon.textContent = saved === 'dark' ? 'ðŸŒ™' : 'ðŸŒž';
  </script>

  <!-- Password Strength Script -->
  <script src="{{ url_for('static', filename='js/password.js') }}"></script>
</body>
</html> 